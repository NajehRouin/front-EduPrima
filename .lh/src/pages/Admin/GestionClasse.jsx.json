{
    "sourceFile": "src/pages/Admin/GestionClasse.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 4,
            "patches": [
                {
                    "date": 1748287976303,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1748287990660,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -88,9 +88,9 @@\n   };\r\n \r\n   return (\r\n     <div className=\"p-6 bg-white shadow-md rounded-xl max-w-6xl mx-auto mt-10\">\r\n-     <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4\">\r\n+      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4\">\r\n         <input\r\n           type=\"text\"\r\n           placeholder=\"Rechercher une classe...\"\r\n           value={searchTerm}\r\n"
                },
                {
                    "date": 1748288009803,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -116,9 +116,9 @@\n           >\r\n             Ajouter Enseignant\r\n           </button>\r\n           <button\r\n-            onClick={() => setShowModalSpecialite(true)}\r\n+           // onClick={() => setShowModalSpecialite(true)}\r\n             className=\"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition\"\r\n           >\r\n             Ajouter Spécialité\r\n           </button>\r\n"
                },
                {
                    "date": 1748288416290,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,8 +4,9 @@\n import ModalAjoutClasse from \"../../components/ModalAjoutClasse\";\r\n import AjouterEleve from \"../../components/AjouterEleve\";\r\n import ModalModifierClasse from \"../../components/ModalModifierClasse\";\r\n import AjouterProfesseur from \"../../components/AjouterProfesseur\";\r\n+import AjouterSpecialite from \"../../components/AjouterSpecialite\";\r\n \r\n function GestionClasse() {\r\n   const [classes, setClasses] = useState([]);\r\n   const [currentPage, setCurrentPage] = useState(1);\r\n@@ -17,8 +18,10 @@\n   const [showEditModal, setShowEditModal] = useState(false);\r\n   const [classeToEdit, setClasseToEdit] = useState(null);\r\n   const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n   const [classeToDelete, setClasseToDelete] = useState(null);\r\n+const [showModalSpecialite,setShowModalSpecialite]=useState(false)\r\n+\r\n   const fetchClasses = async () => {\r\n     try {\r\n       const dataResponse = await fetch(Apiclasse.getAllClasseByEleve.url, {\r\n         method: Apiclasse.getAllClasseByEleve.method,\r\n@@ -116,9 +119,9 @@\n           >\r\n             Ajouter Enseignant\r\n           </button>\r\n           <button\r\n-            // onClick={() => setShowModalSpecialite(true)}\r\n+            onClick={() => setShowModalSpecialite(true)}\r\n             className=\"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition\"\r\n           >\r\n             Ajouter Spécialité\r\n           </button>\r\n@@ -278,8 +281,20 @@\n           classeToEdit={classeToEdit}\r\n           fetchdata={fetchClasses}\r\n         />\r\n       )}\r\n+\r\n+\r\n+      {\r\n+        showModalSpecialite && (\r\n+          <AjouterSpecialite\r\n+             isOpen={showModalSpecialite}\r\n+          onClose={() => setShowModalSpecialite(false)}\r\n+       \r\n+          fetchdata ={fetchClasses}\r\n+          />\r\n+        )\r\n+      }\r\n     </div>\r\n   );\r\n }\r\n \r\n"
                },
                {
                    "date": 1748454459789,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,8 +6,9 @@\n import ModalModifierClasse from \"../../components/ModalModifierClasse\";\r\n import AjouterProfesseur from \"../../components/AjouterProfesseur\";\r\n import AjouterSpecialite from \"../../components/AjouterSpecialite\";\r\n \r\n+\r\n function GestionClasse() {\r\n   const [classes, setClasses] = useState([]);\r\n   const [currentPage, setCurrentPage] = useState(1);\r\n   const [searchTerm, setSearchTerm] = useState(\"\");\r\n"
                }
            ],
            "date": 1748287976303,
            "name": "Commit-0",
            "content": "import React, { useEffect, useState } from \"react\";\r\nimport Apiclasse from \"../../Api/classe\";\r\nimport { FiEdit, FiTrash2 } from \"react-icons/fi\";\r\nimport ModalAjoutClasse from \"../../components/ModalAjoutClasse\";\r\nimport AjouterEleve from \"../../components/AjouterEleve\";\r\nimport ModalModifierClasse from \"../../components/ModalModifierClasse\";\r\nimport AjouterProfesseur from \"../../components/AjouterProfesseur\";\r\n\r\nfunction GestionClasse() {\r\n  const [classes, setClasses] = useState([]);\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const rowsPerPage = 3;\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [showModalEleve, setShowModalEleve] = useState(false);\r\n  const [showModalProf, setShowModalProf] = useState(false);\r\n  const [showEditModal, setShowEditModal] = useState(false);\r\n  const [classeToEdit, setClasseToEdit] = useState(null);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n  const [classeToDelete, setClasseToDelete] = useState(null);\r\n  const fetchClasses = async () => {\r\n    try {\r\n      const dataResponse = await fetch(Apiclasse.getAllClasseByEleve.url, {\r\n        method: Apiclasse.getAllClasseByEleve.method,\r\n        credentials: \"include\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      });\r\n\r\n      const data = await dataResponse.json();\r\n      setClasses(data.result || []);\r\n    } catch (error) {\r\n      console.error(\"Erreur lors de la récupération des classes:\", error);\r\n    }\r\n  };\r\n  useEffect(() => {\r\n    fetchClasses();\r\n  }, []);\r\n\r\n  const filteredClasses = classes.filter(\r\n    (classe) =>\r\n      classe.nomClasse.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n      classe.niveau.toLowerCase().includes(searchTerm.toLowerCase())\r\n  );\r\n\r\n  const totalPages = Math.ceil(filteredClasses.length / rowsPerPage);\r\n  const paginatedData = filteredClasses.slice(\r\n    (currentPage - 1) * rowsPerPage,\r\n    currentPage * rowsPerPage\r\n  );\r\n\r\n  const handleEdit = (classe) => {\r\n    setClasseToEdit(classe);\r\n    setShowEditModal(true);\r\n  };\r\n\r\n  const handleDelete = (classe) => {\r\n    setClasseToDelete(classe);\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  const cancelDelete = () => {\r\n    setClasseToDelete(null);\r\n    setShowDeleteModal(false);\r\n  };\r\n\r\n  const confirmDelete = async () => {\r\n    try {\r\n      const response = await fetch(Apiclasse.deleteClasse.url, {\r\n        method: Apiclasse.deleteClasse.method,\r\n        credentials: \"include\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({ idClass: classeToDelete._id }),\r\n      });\r\n\r\n      if (response.ok) {\r\n        fetchClasses(); // refresh list\r\n        setShowDeleteModal(false);\r\n      } else {\r\n        console.error(\"Erreur de suppression\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Erreur lors de la suppression:\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"p-6 bg-white shadow-md rounded-xl max-w-6xl mx-auto mt-10\">\r\n     <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-4\">\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Rechercher une classe...\"\r\n          value={searchTerm}\r\n          onChange={(e) => setSearchTerm(e.target.value)}\r\n          className=\"w-full md:w-1/3 px-4 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-300\"\r\n        />\r\n        <div className=\"flex gap-3\">\r\n          <button\r\n            onClick={() => setShowModal(true)}\r\n            className=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition\"\r\n          >\r\n            Ajouter Classe\r\n          </button>\r\n          <button\r\n            onClick={() => setShowModalEleve(true)}\r\n            className=\"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 transition\"\r\n          >\r\n            Ajouter Élève\r\n          </button>\r\n          <button\r\n            onClick={() => setShowModalProf(true)}\r\n            className=\"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 transition\"\r\n          >\r\n            Ajouter Enseignant\r\n          </button>\r\n          <button\r\n            onClick={() => setShowModalSpecialite(true)}\r\n            className=\"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 transition\"\r\n          >\r\n            Ajouter Spécialité\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"min-w-full divide-y divide-gray-200 border border-gray-200 rounded-lg overflow-hidden\">\r\n          <thead className=\"bg-blue-100 text-blue-800 text-sm font-semibold\">\r\n            <tr>\r\n              <th className=\"px-6 py-3 text-left\">Niveau</th>\r\n              <th className=\"px-6 py-3 text-left\">Nom de la classe</th>\r\n              <th className=\"px-6 py-3 text-left\">Nombre des élève</th>\r\n              <th className=\"px-6 py-3 text-left\">Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"divide-y divide-gray-100 text-gray-700\">\r\n            {paginatedData.length > 0 ? (\r\n              paginatedData?.map((classe) => (\r\n                <tr key={classe._id} className=\"hover:bg-gray-50\">\r\n                  <td className=\"px-6 py-4\">{classe.niveau}</td>\r\n                  <td className=\"px-6 py-4 capitalize\">{classe.nomClasse}</td>\r\n                  <td className=\"px-6 py-4 capitalize\">\r\n                    {classe.nombreEleves}\r\n                  </td>\r\n                  <td className=\"px-6 py-4 flex gap-4 items-center\">\r\n                    <button\r\n                      onClick={() => handleEdit(classe)}\r\n                      className=\"text-blue-600 hover:text-blue-800\"\r\n                      title=\"Modifier\"\r\n                    >\r\n                      <FiEdit size={18} />\r\n                    </button>\r\n                    <button\r\n                      onClick={() => handleDelete(classe)}\r\n                      className=\"text-red-600 hover:text-red-800\"\r\n                      title=\"Supprimer\"\r\n                    >\r\n                      <FiTrash2 size={18} />\r\n                    </button>\r\n                  </td>\r\n                </tr>\r\n              ))\r\n            ) : (\r\n              <tr>\r\n                <td colSpan=\"3\" className=\"text-center py-6 text-gray-400\">\r\n                  Aucune classe trouvée.\r\n                </td>\r\n              </tr>\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      <div className=\"flex justify-end mt-4 gap-2\">\r\n        <button\r\n          onClick={() => setCurrentPage((prev) => Math.max(prev - 1, 1))}\r\n          className=\"px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded disabled:opacity-50\"\r\n          disabled={currentPage === 1}\r\n        >\r\n          Précédent\r\n        </button>\r\n        {[...Array(totalPages)].map((_, index) => (\r\n          <button\r\n            key={index}\r\n            onClick={() => setCurrentPage(index + 1)}\r\n            className={`px-3 py-1 rounded ${\r\n              currentPage === index + 1\r\n                ? \"bg-blue-600 text-white\"\r\n                : \"bg-gray-100 hover:bg-gray-200\"\r\n            }`}\r\n          >\r\n            {index + 1}\r\n          </button>\r\n        ))}\r\n        <button\r\n          onClick={() =>\r\n            setCurrentPage((prev) => Math.min(prev + 1, totalPages))\r\n          }\r\n          className=\"px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded disabled:opacity-50\"\r\n          disabled={currentPage === totalPages}\r\n        >\r\n          Suivant\r\n        </button>\r\n      </div>\r\n\r\n      {/*modal supprime */}\r\n\r\n      {showDeleteModal && (\r\n        <div className=\"fixed inset-0 bg-gray-800 bg-opacity-50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-white border-l-4 border-red-600 p-6 rounded-lg shadow-xl w-96 relative\">\r\n            <div className=\"flex items-center justify-center mb-4\">\r\n              <div className=\"text-red-600 text-4xl mr-2\">⚠️</div>\r\n              <h2 className=\"text-xl font-semibold text-red-700\">\r\n                Confirmation de suppression\r\n              </h2>\r\n            </div>\r\n            <p className=\"text-gray-700 text-center mb-2\">\r\n              Êtes-vous sûr de vouloir supprimer la classe{\" \"}\r\n              <span className=\"font-semibold text-black\">\r\n                {classeToDelete?.nomClasse}\r\n              </span>{\" \"}\r\n              ?\r\n            </p>\r\n            <p className=\"text-sm text-center text-red-600 mb-6\">\r\n              Cette action est irréversible. Toutes les données associées seront\r\n              également supprimées.\r\n            </p>\r\n            <div className=\"flex justify-around\">\r\n              <button\r\n                onClick={cancelDelete}\r\n                className=\"px-4 py-2 bg-gray-300 text-gray-800 rounded-md hover:bg-gray-400 transition\"\r\n              >\r\n                Annuler\r\n              </button>\r\n              <button\r\n                onClick={confirmDelete}\r\n                className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition\"\r\n              >\r\n                Supprimer\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Modal d'ajout (placeholder) */}\r\n\r\n      {showModal && (\r\n        <ModalAjoutClasse\r\n          fetchdata={fetchClasses}\r\n          isOpen={showModal}\r\n          onClose={() => setShowModal(false)}\r\n        />\r\n      )}\r\n\r\n      {showModalEleve && (\r\n        <AjouterEleve\r\n          fetchdata={fetchClasses}\r\n          isOpen={showModalEleve}\r\n          closeModal={() => setShowModalEleve(false)}\r\n        />\r\n      )}\r\n\r\n      {showModalProf && (\r\n        <AjouterProfesseur\r\n          isOpen={showModalProf}\r\n          fetchdata={fetchClasses}\r\n          closeModal={() => setShowModalProf(false)}\r\n        />\r\n      )}\r\n\r\n      {showEditModal && (\r\n        <ModalModifierClasse\r\n          isOpen={showEditModal}\r\n          onClose={() => setShowEditModal(false)}\r\n          classeToEdit={classeToEdit}\r\n          fetchdata={fetchClasses}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default GestionClasse;\r\n"
        }
    ]
}